phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date") %>% select(Date, phu,cases)
library(tidyverse)
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date") %>% select(Date, phu,cases)
phucases$Date <- mdy(phucases$Date)
onttrain <-filter(phucases,phu == "Ontario", Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(phucases,phu == "Ontario", Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0))
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
library(forecast)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date") %>% select(Date, phu,cases)
phucases$Date <- mdy(phucases$Date)
onttrain <-filter(phucases,phu == "Ontario", Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(phucases,phu == "Ontario", Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0))
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
install.packages("rtweet")
ggsave("data/covidarima.png", plot=last_plot())
Sys.setenv( TWITTER_CONSUMER_API_KEY= "rJZoGuP3DK2HfniEL83TRyNQ7")
Sys.getenv(TWITTER_CONSUMER_API_KEY)
Sys.getenv("TWITTER_CONSUMER_API_KEY")
Sys.setenv( TWITTER_CONSUMER_API_SECRET= "siAIfvsGOSCX95KZdBNpf26lR5baNwZOxG467hgdVesdhgvrAJ")
Sys.setenv( TWITTER_ACCESS_TOKEN= "1195409521-R3Q5I0a27tMRp2VqKCZhagz0LJDoOr2aUjaZRP3")
Sys.setenv( TWITTER_ACCESS_TOKEN_SECRET= "8tXVOkphLV7T9lpwqHrGrcCZ4T8DYXEFlAIvVuvVFDybO")
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date") %>% select(Date, phu,cases)
phucases$Date <- mdy(phucases$Date)
onttrain <-filter(phucases,phu == "Ontario", Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(phucases,phu == "Ontario", Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0))
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ggsave("data/covidarima.png", plot=last_plot(),width=8,height=4.5,dpi=200)
# Tweet the Graph
covidplots_token <- rtweet::create_token(
app = "covidplots",
consumer_key =    Sys.getenv("TWITTER_CONSUMER_API_KEY"),
consumer_secret = Sys.getenv("TWITTER_CONSUMER_API_SECRET"),
access_token =    Sys.getenv("TWITTER_ACCESS_TOKEN"),
access_secret =   Sys.getenv("TWITTER_ACCESS_TOKEN_SECRET"),
)
post_tweet("Ontario Cases Forecast from ARIMA(14,1,0) Model",
media="data/covidarima.png",
token=covidplots_token)
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
accessed_date
post_tweet(paste("Ontario cases forecast from ARIMA(14,1,0) Model. The model is estimated from all available COVID data up to Nov 1, and forecased out 2 weeks.  Updated with actual values up to ",accessed_date),
media="data/covidarima.png",
token=covidplots_token)
post_tweet(paste("Ontario cases forecast from ARIMA(14,1,0) model. The model is estimated from all available COVID data up to Nov 1, and forecased out 2 weeks.  Black is actual data, purple is forecast with 95% forecast interval. Updated with actual values up to",accessed_date),
media="data/covidarima.png",
token=covidplots_token)
# Tweet the Graph
covidplots_token <- rtweet::create_token(
app = "covidplots",
consumer_key =    Sys.getenv("TWITTER_CONSUMER_API_KEY"),
consumer_secret = Sys.getenv("TWITTER_CONSUMER_API_SECRET"),
access_token =    Sys.getenv("TWITTER_ACCESS_TOKEN"),
access_secret =   Sys.getenv("TWITTER_ACCESS_TOKEN_SECRET"),
)
post_tweet(paste("Ontario cases forecast from ARIMA(14,1,0) model. The model is estimated from all available COVID data up to Nov 1, and forecased out 2 weeks.  Black is actual data, purple is forecast with 95% forecast interval. Updated with actual values up to",accessed_date),
media="data/covidarima.png",
token=covidplots_token)
arimamodel
?Arima()
plotdata
fc<-forecast(arimamodel,h=14, bootstrap = TRUE)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
plotdata
summ(arimamodel)
?seasadj()
autoplot(ontts)
ggtsdisplay(ontts)
ontts %>% diff() %>% ggtsdisplay(main="")
?Arima()
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
arimamodel
autoplot(forecast(arimamodel))
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date") %>% select(Date, phu,cases)
phucases$Date <- mdy(phucases$Date)
onttrain <-filter(phucases,phu == "Ontario", Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(phucases,phu == "Ontario", Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ontts %>% diff() %>% ggtsdisplay(BoxCox(,0.3))
ggtsdisplay(BoxCox(diff(ontts),0.3))
ggtsdisplay(BoxCox(ontts,0.3))
ggtsdisplay(diff(ontts))
ggtsdisplay(BoxCox(diff(ontts),0.3032865))
arimamodel
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
summary(arimamodel)
summary.forecast(arimamodel)
summary.forecast
View(onttrain)
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date")
View(phucases)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date", "hosp" = "Hospitalizations.by.reported.date", "deaths" = "Deaths.by.reported.date") %>% select(Date, phu,cases, hosp, deaths)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date", "hosp" = "Hospitalizations.by.reported.date", "deaths" = "Deaths") %>% select(Date, phu,cases, hosp, deaths)
View(phucases)
install.packages("vars")
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(phucases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ggsave("data/covidarima.png", plot=last_plot(),width=8,height=4.5,dpi=200)
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
accessed_date
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto")
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-08-25") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-08-25") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto")
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-08-25") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-08-25") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-08-25") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-08-25") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto")
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
?Arima()
arimamodel
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto", biasadj = TRUE)
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto", biasadj = FALSE)
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
?arima()
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
