arimamodel
?Arima()
plotdata
fc<-forecast(arimamodel,h=14, bootstrap = TRUE)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
plotdata
summ(arimamodel)
?seasadj()
autoplot(ontts)
ggtsdisplay(ontts)
ontts %>% diff() %>% ggtsdisplay(main="")
?Arima()
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
arimamodel
autoplot(forecast(arimamodel))
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date") %>% select(Date, phu,cases)
phucases$Date <- mdy(phucases$Date)
onttrain <-filter(phucases,phu == "Ontario", Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(phucases,phu == "Ontario", Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ontts %>% diff() %>% ggtsdisplay(BoxCox(,0.3))
ggtsdisplay(BoxCox(diff(ontts),0.3))
ggtsdisplay(BoxCox(ontts,0.3))
ggtsdisplay(diff(ontts))
ggtsdisplay(BoxCox(diff(ontts),0.3032865))
arimamodel
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
summary(arimamodel)
summary.forecast(arimamodel)
summary.forecast
View(onttrain)
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date")
View(phucases)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date", "hosp" = "Hospitalizations.by.reported.date", "deaths" = "Deaths.by.reported.date") %>% select(Date, phu,cases, hosp, deaths)
phucases<- read.csv("All case trends data.csv") %>% rename("phu" = "Public.Health.Unit", "cases" = "Cases.by.reported.date", "hosp" = "Hospitalizations.by.reported.date", "deaths" = "Deaths") %>% select(Date, phu,cases, hosp, deaths)
View(phucases)
install.packages("vars")
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(phucases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ggsave("data/covidarima.png", plot=last_plot(),width=8,height=4.5,dpi=200)
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
accessed_date
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto")
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-08-25") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-08-25") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto")
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-08-25") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-08-25") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-08-25") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-08-25") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto")
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
?Arima()
arimamodel
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto", biasadj = TRUE)
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
arimamodel<-Arima(ontts, order=c(30,1,0), lambda="auto", biasadj = FALSE)
fc<-forecast(arimamodel,h=30)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=30))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
?arima()
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
library(tidyverse)
library(zoo)
library(ggthemes)
library(lubridate)
library(xts)
library(forecast)
library(rtweet)
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
?stl()
?Arima()
?xts()
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, onttrain$Date, frequency = 7)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
ontts
stl_ontts <-stl(ontts,"periodic")
stl_ontts <-stl(ontts,7)
ontts <-xts(onttrain$cases, onttrain$Date, frequency = 1)
?ts()
ontts <-xts(onttrain$cases, onttrain$Date, frequency = 365)
stl_ontts <-stl(ontts,"periodic")
ontts <-xts(onttrain$cases, order.by=onttrain$Date)
periodicity(ontts)
attr(ontts, 'frequency') <-7
stl_ontts <-stl(ontts,"periodic")
stl_ontts
plot(stl_ontts$time.series[,2])
plot(stl_ontts$time.series[,3])
plot(stl_ontts$time.series[,1])
plot(stl_ontts)
stl_ontts$time.series
ontts2<-xts(onttrain$cases, stl_ontts$time.series, order.by=onttrain$Date)
ontts2
ontts
stl_ontts
ontts_sa<-xts((onttrain$cases -stl_ontts$time.series[,1]), order.by=onttrain$Date)
ontts_sa
plot(ontts_sa)
plot(ontts)
plot(ontts_sa)
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_line(data=filter(ontts_sa, Date>"2021-08-01"),aes(y=ontts_sa), size=1.2, alpha=0.7)
df<-as_data_frame(ontts_sa)
df
test<-bind_cols(onttrain,df)
test
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=V1), size=1.2, alpha=0.7)
ggplot() +
geom_line(data=filter(test, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_line(data=filter(test, Date>"2021-08-01"),aes(x=Date, y=V1), size=1.2, alpha=0.7)
ggplot() +
geom_line(data=filter(test, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_line(data=filter(test, Date>"2021-08-01"),aes(x=Date, y=V1), size=1.2, alpha=0.7) +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()
ggplot() +
geom_line(data=filter(test, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_line(data=filter(test, Date>"2021-08-01"),aes(x=Date, y=V1), size=1.2, alpha=0.7, color="red") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()
?Arima()
frequency(ontts)
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, order.by=onttrain$Date)
attr(ontts, 'frequency') <-7
stl_ontts <-stl(ontts,"periodic")
ontts_sa<-xts((onttrain$cases -stl_ontts$time.series[,1]), order.by=onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), seasonal=c(14,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
arimamodel<-Arima(ontts, order=c(14,1,0), seasonal=c(0,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_line(data=filter(ontts_sa, Date>"2021-08-01"),aes(y=ontts_sa), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
arimamodel<-Arima(ontts, order=c(14,1,0), seasonal=c(1,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
arimamodel
arimamodel<-Arima(ontts, order=c(14,1,0), seasonal=c(0,0,0), lambda="auto")
arimamodel
arimamodel<-Arima(ontts, order=c(5,1,0), seasonal=c(0,1,0), lambda="auto")
arimamodel
arimamodel<-Arima(ontts, order=c(5,1,0), seasonal=c(1,1,0), lambda="auto")
arimamodel
arimamodel<-Arima(ontts, order=c(5,1,0), seasonal=c(0,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
arimamodel<-Arima(ontts, order=c(14,1,0), seasonal=c(0,1,0), lambda="auto")
arimamodel
arimamodel<-Arima(ontts, order=c(5,1,0), seasonal=c(0,1,0), lambda="auto")
arimamodel<-Arima(ontts, order=c(5,1,0), seasonal=c(0,1,0), lambda="auto")
arimamodel
arimamodel<-Arima(ontts, order=c(5,1,0), seasonal=c(1,1,0), lambda="auto")
arimamodel
arimamodel<-Arima(ontts, order=c(14,1,0), seasonal=c(1,1,0), lambda="auto")
arimamodel
arimamodel<-Arima(ontts, order=c(14,1,0), seasonal=c(2,1,0), lambda="auto")
arimamodel
fc<-forecast(arimamodel,h=14)
plotdata<-data.frame(fc, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_line(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, order.by=onttrain$Date)
attr(ontts, 'frequency') <-7
stl_ontts <-stl(ontts,"periodic")
ontts_sa<-xts((onttrain$cases -stl_ontts$time.series[,1]), order.by=onttrain$Date)
onteval<-filter(ontcases, Date >"2021-11-01") %>% select(Date, cases)
arimamodel<-Arima(ontts, order=c(14,1,0), seasonal=c(0,0,0), lambda="auto")
arimamodel2<-Arima(ontts, order=c(14,1,0), seasonal=c(2,1,0), lambda="auto")
fc<-forecast(arimamodel,h=14)
fc2<-forecast(arimamodel2,h=14)
plotdata<-data.frame(fc,fc2, Date=seq.Date(max(onttrain$Date) + 1, by="1 day", length.out=14))
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast.1), color="darkorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
ggplot() +
geom_line(data=filter(onttrain, Date>"2021-08-01"),aes(x=Date, y=cases), size=1.2, alpha=0.7) +
geom_ribbon(data=plotdata, aes(x=Date,ymin=Lo.95, ymax=Hi.95), fill="mediumorchid1", alpha=0.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast), color="mediumorchid1", size=1.2) +
geom_line(data=plotdata,aes(x=Date, y=Point.Forecast.1), color="darkorchid1", size=1.2) +
geom_point(data=onteval,aes(x=Date, y=cases), color="black") +
scale_x_date(breaks = scales::pretty_breaks(n = 12)) +
expand_limits(y=0) +
theme_fivethirtyeight()+
ylab("Ontario Covid Cases") +
ggtitle("COVID-19 Cases Per Day with ARIMA(14,1,0) Forecast")
arimamodel2<-Arima(ontts, order=c(14,1,0), seasonal=c(3,1,0), lambda="auto")
arimamodel2
accessed_date<-format(as.POSIXlt(Sys.time(), "EST5EDT" ),"%b %d")
ontcases<- read.csv("Full COVID-19 Summary Data for Ontario.csv") %>% rename("cases" = "Change.in.cases") %>% select(Date, cases)
ontcases$Date <- mdy(ontcases$Date)
onttrain <-filter(ontcases, Date <="2021-11-01") %>% select(Date, cases)
ontts <-xts(onttrain$cases, order.by=onttrain$Date)
attr(ontts, 'frequency') <-7
stl_ontts <-stl(ontts,"periodic")
plot(stl_ontts)
plot(stl_ontts, major.ticks = "weeks")
plot(stl_ontts, main = "Ontario Covid Cases Time Series Decomposition")
autoplot(stl_ontts)
autoplot()
?stl()
plot.stl(stl_ontts)
